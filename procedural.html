<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>BoltView: Procedural Views</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">BoltView
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('procedural.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Procedural Views </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p float="left" align="center"></p>
<p><img src="./checkerboard_superposition.jpg" alt="Checkerboard superposition" title="Checkerboard superposition" width="300" class="inline"/> </p>
<p>This will be a short presentatation how a procedural image views can be used. We will generate an image which consists of multiple checkerboards with different tile size being superpositioned over each other and summed.</p>
<p>The BoltView library provides an purely procedural image view which behaves like checker board image view, although the checker board image does not exist in memory. The view computes proper value on demand when executing the <code>operator[]</code>. The library also provides overloads of arithmetic operators, which can be used for basic manipulation with image views, although the view they return also does not have data representation in memory. A wrapper view containing operation inputs is returned and calculation happens again on demand.</p>
<p>Types of all these procedural views are known in compile time, so we can do a little trick and create a wrapper view which does our checker board summation on demand.</p>
<div class="fragment"><div class="line"> {c++}</div>
<div class="line">template&lt;int... tArgs&gt;</div>
<div class="line">auto generate(Int2 size, std::integer_sequence&lt;int, tArgs...&gt; seq) {</div>
<div class="line">    return fold(</div>
<div class="line">        [](auto first, auto second) { return first + second; },</div>
<div class="line">        checkerboard(uint8_t(0), uint8_t(255/seq.size()), Int2(power(3, tArgs), FillTag{}), size)</div>
<div class="line">        ...);</div>
<div class="line">}</div>
</div><!-- fragment --><p>We used a integer sequence to provide arguments for each checkerboard level. Because in CUDA we are currently limited to C++14, we cannot use <a href="https://en.cppreference.com/w/cpp/language/fold">fold expressions</a> for parameter pack, which are available in C++17, so we use a utility function <code><a class="el" href="namespacebolt.html#ad41c2b26d621ea8b733e6b1fde276158">fold()</a></code> which applies operation passed as the first parameter and applies it to the variadic parameter list like <code>(((a op b) op c) op d)</code>.</p>
<p>The presented <code>generate()</code> function does not do any calculation - it returns procedural view which does lazy evaluation. To get actual pixel values we need to copy the values into actual image, which we can save as in the following snippet. </p><div class="fragment"><div class="line"> {c++}</div>
<div class="line">Int2 size{2187, 2187};</div>
<div class="line"> </div>
<div class="line">auto im = generate(size, std::make_integer_sequence&lt;int, 7&gt;{});</div>
<div class="line"> </div>
<div class="line">HostImage&lt;uint8_t, 2&gt; output_image(size);</div>
<div class="line">copy(im, view(output_image));</div>
<div class="line">saveImage(&quot;output.jpg&quot;, constView(output_image));</div>
</div><!-- fragment --><p>Output of this example is shown at the top of the page. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
